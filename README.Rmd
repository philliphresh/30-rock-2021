---
title: "Analyzing 30 Rock Data"
author: "Phillip Sanderell"
output: github_document
---

"Science is my most favorite subject, especially the Old Testament." Continuing my one-show streak of analyzing data for my favorite television shows, I have chosen to explore Tina Fey's *30 Rock*. In this post I look forward to learning about what it takes to make a truly fantastic show, and perhaps impress my friends from The Second City.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(showtext)
showtext_auto()
font_add("Monsterrat", "Montserrat-Regular.ttf")
yellow <- "#FFFFAC"
light_theme <- 
  theme_minimal() +
  theme(text = element_text(family = "Monsterrat", color = "black"),
        plot.title = element_text(size = 15),
        axis.text = element_text(color = "black", size = 10),
        axis.title = element_text(color = "black", size = 12),
        plot.title.position = "plot")
theme_set(light_theme)
```

```{r include=FALSE}
rock <- read_csv("https://raw.githubusercontent.com/philliphresh/30-rock-2021/main/rock.csv")
```

# Exploring episode metadata

## IMDb rating

IMDb ratings tend to be my go-to metric for scoring episodes, and something that I find particularly interesting. I suppose I assume that episodes with higher IMDb ratings had higher Neilsen ratings or generated more audience for the show. The plot below shows the distribution of IMDb ratings for every regular-season episode of the show.

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, dpi=600}
nbc_pallete <- c(`1` = "#FCB711",
                 `2` = "#F37021",
                 `3` = "#CC004C",
                 `4` = "#6460AA",
                 `5` = "#0089D0",
                 `6` = "#0DB14B",
                 `7` = "black")

rock %>% 
  mutate(season = as.character(season)) %>% 
  ggplot(aes(rating, fill = season)) +
  geom_histogram(binwidth = .1) +
  scale_fill_manual(values = nbc_pallete,
                    name = "Season") +
  theme(panel.grid.minor.y = element_blank(),
        plot.caption.position = "plot") +
  labs(title = "30 ROCK's IMDb ratings generally range between 7.5 and 8.6",
       x = "Episode Rating",
       y = "Count",
       caption = "\nData from IMDb.com  |  @PhilliPhresh")
```

The ratings do seem to have an approximately normal distribution centered at eight stars. Something worth noting is that while IMDb ratings range from 0 to 10, I find episode ratings for various shows hover around 8 starts--perhaps there is some psychological reason for that, but unfortunately we have no way of knowing, medicine is not a science.

The plot above is useful for examining episode ratings overall, but it is easy to tell if certain seasons rate better than others. The next plot was made in an effort to make this more clear. Each dot represents an episode going in order of air date from left to right, colored by season, and sized by number of IMDb votes. The "notched" box plots show the 25th, 50th, and 75th percentiles of ratings for each season--if the notches in different season's boxes don't overlap, it suggests the medians are significantly different.

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, dpi=600}
season_labels <- c("Season 1", "2", "3", "4", "5", "6", "7")
names(season_labels) <- 1:7

ann_1 <- tibble(season = 1, ep_no = 7, rating = 7.3, hjust = 0,
                label = "Pilot")
ann_2 <- tibble(season = 1, ep_no = 3, rating = 7.4, hjust = 0, 
                label = "Unaired Pilot")
ann_3 <- tibble(season = 6, ep_no = 16, rating = 7.3, hjust = 1, 
                label = "Queen of Jordan 2: The Mystery\nof the Phantom Pooper")
ann_4 <- tibble(season = 7, ep_no = 10, rating = 9.0, hjust = 1, 
                label = "Hogcock!/Last Lunch")

rock %>% 
  # arrange(-rating)
  mutate(season = fct_reorder(as.character(season), air_date)) %>% 
  
  ggplot(aes(ep_no, rating)) +
  geom_point(aes(size = no_votes, color = season)) + 
  geom_boxplot(aes(y = rating), color = "black",
               size = 1, alpha = .2, notch = TRUE, 
               coef = 0, outlier.color = NA) +
  facet_grid(cols = vars(season), 
             scales = "free_x", 
             labeller = labeller(season = season_labels)) +
  geom_text(aes(label = label, hjust = hjust), data = ann_1) +
  geom_text(aes(label = label, hjust = hjust), data = ann_2) +
  geom_text(aes(label = label, hjust = hjust), data = ann_3, lineheight = .7) +
  geom_text(aes(label = label, hjust = hjust), data = ann_4) +
  scale_color_manual(values = nbc_pallete) +
  scale_fill_manual(values = nbc_pallete) +
  guides(size = "none", color = "none", fill = "none") +
  coord_cartesian(clip = 'off') +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.x = element_blank(),
        axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        strip.text = element_text(size = 10)) +
  labs(title = "The distribution of ratings gets more variable over time",
       y = "Episode Rating",
       caption = "\nData from IMDb.com  |  @PhilliPhresh")
```

## Prevalence of writers

I would like to see a plot of most common writers by season.

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=7, dpi=600}
rock %>% 
  separate(writers, paste0("writer_", 1:4), sep = "\\_\\_") %>% 
  pivot_longer(writer_1:writer_4, names_to = NULL, values_to = "writer") %>% 
  filter(!is.na(writer)) %>% 
  group_by(writer) %>% 
  mutate(tot_eps = n()) %>% 
  group_by(season, writer) %>% 
  summarise(n = n(),
            tot_eps = mean(tot_eps)) %>% 
  ungroup() %>% 
  mutate(writer = fct_reorder(writer, tot_eps)) %>% 
  
  ggplot(aes(n, writer, fill = as.character(season))) + 
  geom_col() + 
  facet_grid(cols = vars(season),
             labeller = labeller(season = season_labels)) +
  scale_fill_manual(values = nbc_pallete) +
  scale_x_continuous(breaks = seq(1, 9, 2)) +
  guides(fill = "none") +
  theme(panel.grid.minor = element_blank(),
        axis.title.y = element_blank()) +
  labs(title = "There seem to be three tiers of writers:",
       subtitle = "    A.    Original writing team\n    B.    New writers brought on in season four\n    C.    Various guest writers",
       x = "Number of episodes written",
       caption = "\nData from IMDb.com  |  @PhilliPhresh")
```

Tina Fey clearly did not sleep, having had the highest number of episodes written (or tied for) in five out of seven seasons, all while staring in every episode. Robert Carlock wrote the second most total episodes for the show, which is fortunate because I love his writing style-quick, ridiculous, and too witty to keep up with sometimes. Tina Fey and Robert Carlock went on to co-create *The Unbreakable Kimmy Schmidt*, which would be another interesting show to analyze, bringing along a lot of 30 Rock writing alumna. Tracy Wigfield created the NBC series *Great News*, another great watch. I believe Donald Glover is credited as a story consultant writer on some episodes that do not show up here, but looks like he worked on the actual script for two episodes.

## Prevalence of directors

I would like to see a similar plot of most common directors by season.

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=7, dpi=600}
rock %>% 
  separate(directors, paste0("director_", 1:4), sep = "\\_\\_") %>% 
  pivot_longer(director_1:director_4, names_to = NULL, values_to = "director") %>% 
  filter(!is.na(director)) %>% 
  group_by(director) %>% 
  mutate(tot_eps = n()) %>% 
  group_by(season, director) %>% 
  summarise(n = n(),
            tot_eps = mean(tot_eps)) %>% 
  ungroup() %>% 
  mutate(director = fct_reorder(director, tot_eps)) %>% 
  
  ggplot(aes(n, director, fill = as.character(season))) + 
  geom_col() + 
  facet_grid(cols = vars(season),
             labeller = labeller(season = season_labels)) +
  scale_fill_manual(values = nbc_pallete) +
  scale_x_continuous(breaks = seq(1, 9, 2)) +
  guides(fill = "none") +
  theme(panel.grid.minor = element_blank(),
        axis.title.y = element_blank()) +
  labs(title = "The top four directors dominate, others seem to come when available",
       x = "Number of episodes directed",
       caption = "\nData from IMDb.com  |  @PhilliPhresh")
```

I wonder what happened to Adam Bernstein? He directed just as much as Don Scardino in season one and then didn't direct anymore. Jeff Richmond directed a number of later episodes, avid watchers may recognize his name as the composer for the series (or as Tina Fey's husband in real life). I notice Robert Carlock, the second-most credited writer, directed an episode in the final season--I wonder if there is any other writer/director overlap.
